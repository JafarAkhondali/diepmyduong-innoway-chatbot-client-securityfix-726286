!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("innoway",[],e):"object"==typeof exports?exports.innoway=e():t.innoway=e()}(this,function(){return function(t){function e(n){if(a[n])return a[n].exports;var o=a[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){t.exports=a(9)},function(t,e){"use strict";e.ServerConfig={host:"http://phincafe.vn",filesPath:"/uploads/",apiPath:"/apis/v1/",FBAPI:"893757327425340",GoogleAPI:"235416124042-2papc83kbjf14g3m9on0cal3bmihdqm9.apps.googleusercontent.com"},e.APIPath=e.ServerConfig.host+e.ServerConfig.apiPath},function(t,e,a){"use strict";var n=a(1);e.CustomerConfig={authTokenStorage:"innoway.Customer.auth.token",cardsStorage:"innoway.Customer.cards",loginUrl:n.APIPath+"CustomerLogin",signUpUrl:n.APIPath+"Register",updateCustomerUrl:n.APIPath+"EditCustomer",getBillsUrl:n.APIPath+"GetListBillFromCustomer",getBillUrl:n.APIPath+"GetBill",getAllProductsUrl:n.APIPath+"GetAllProduct",sendBillUrl:n.APIPath+"SendBill",addFeedbackUrl:n.APIPath+"AddFeedback",getPromotionsUrl:n.APIPath+"Promotions",getCustomerUrl:n.APIPath+"GetCustomer",getBlogsUrl:n.ServerConfig.host+"/blog/wp-json/posts"}},function(t,e,a){"use strict";var n=a(1);e.EmployeeConfig={GetAllCategoryUrl:n.APIPath+"GetAllCategory"}},function(t,e,a){"use strict";var n=a(1);e.FBConfig=function(){var t=document,e="script",a="facebook-jssdk";window.fbAsyncInit=function(){FB.init({appId:n.ServerConfig.FBAPI,xfbml:!0,version:"v2.9"}),FB.AppEvents.logPageView()};var o,s=t.getElementsByTagName(e)[0];t.getElementById(a)||(o=t.createElement(e),o.id=a,o.src="//connect.facebook.net/en_US/sdk.js",s.parentNode.insertBefore(o,s))}},function(t,e,a){"use strict";var n=a(1);e.GoogleConfig=function(){var t=document,e="script",a="google-jssdk",o=t.getElementsByTagName("head")[0],s=t.createElement("meta");s.name="google-signin-client_id",s.content=n.ServerConfig.GoogleAPI,o.parentNode.insertBefore(s,o);var r,i=t.getElementsByTagName(e)[0];t.getElementById(a)||(r=t.createElement(e),r.id=a,r.src="https://apis.google.com/js/api.js",r.async=!0,r.onload=function(){gapi.load("auth2",function(){gapi.auth2.init()})},i.parentNode.insertBefore(r,i))}},function(t,e){"use strict";e.CustomerEvents={AuthStateChange:"AuthStateChange",CustomerEdited:"CustomerEdited",CardsChange:"CardsChange"}},function(t,e,a){"use strict";var n=a(2),o=a(1),s=a(6),r=a(4),i=a(5);r.FBConfig(),i.GoogleConfig();var u=function(){function t(e){void 0===e&&(e=null),this.authenticated=!1,this instanceof t&&(null==e&&(e=localStorage.getItem(n.CustomerConfig.authTokenStorage)),null!=e&&this.loginWithToken(e))}return t.prototype.requiedAuthenticate=function(t){return void 0===t&&(t=function(){}),this.authenticated||t("PERMISSION ERROR","You don't have permission to access"),this.authenticated},t.prototype.login=function(t,e,a){var o=this;void 0===a&&(a=function(){}),$.ajax({type:"POST",url:n.CustomerConfig.loginUrl,dataType:"json",data:{Phone:t,Password:e}}).done(function(t){200===t.StatusCode?(o.user=t.Data,o._token=t.Data.Token,o.authenticated=!0,$(o).trigger(s.CustomerEvents.AuthStateChange,o.authenticated),localStorage.setItem(n.CustomerConfig.authTokenStorage,t.Data.Token),a(null,t.Data)):(o.authenticated=!1,$(o).trigger(s.CustomerEvents.AuthStateChange,o.authenticated),a(t.StatusCode,t.StatusMessage))}).fail(function(t,e,n){o.authenticated=!1,$(o).trigger(s.CustomerEvents.AuthStateChange,o.authenticated),a(e,n)})},t.prototype.loginWithToken=function(t,e){var a=this;void 0===e&&(e=function(){}),$.ajax({type:"POST",url:n.CustomerConfig.getCustomerUrl,dataType:"json",headers:{token:t}}).done(function(t){200===t.StatusCode?(a.user=t.Data,a._token=t.Data.Token,a.authenticated=!0,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),localStorage.setItem(n.CustomerConfig.authTokenStorage,t.Data.Token),e(null,t.Data)):(a.authenticated=!1,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),e(t.StatusCode,t.StatusMessage))}).fail(function(t,n,o){a.authenticated=!1,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),e(n,o)})},t.prototype.loginWithGoolge=function(t){void 0===t&&(t=function(){});var e=gapi.auth2.getAuthInstance();e.signIn().then(function(e){console.log(e.getAuthResponse());var a=e.getAuthResponse().id_token;t(null,a)},function(e){t("Authentication failed.",e)})},t.prototype.loginWithFacebook=function(t){void 0===t&&(t=function(){}),FB.login(function(e){e.authResponse?t(null,FB.getAccessToken()):t("User cancelled login or did not fully authorize.",null)})},t.prototype.logout=function(){FB.logout();var t=gapi.auth2.getAuthInstance();t.signOut(),localStorage.removeItem(n.CustomerConfig.authTokenStorage),this._token=null,this.user=null,this.authenticated=!1},t.prototype.signUp=function(t,e){var a=this;void 0===e&&(e=function(){});var o=new FormData;o.append("Phone",t.phone),o.append("Password",t.password),o.append("Fullname",t.fullName),o.append("Email",t.email),o.append("FacebookToken",""),o.append("GoogleToken","");var r={async:!0,crossDomain:!0,url:n.CustomerConfig.signUpUrl,method:"POST",processData:!1,contentType:!1,mimeType:"multipart/form-data",data:o,success:function(t,o,r){var i=JSON.parse(r.responseText);200===i.StatusCode?(a.user=i.Data,a._token=i.Data.Token,a.authenticated=!0,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),localStorage.setItem(n.CustomerConfig.authTokenStorage,i.Data.Token),e(null,i.Data)):(a.authenticated=!1,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),e(i.StatusCode,i.StatusMessage))},error:function(t,n,o){var r=JSON.parse(t.responseText);a.authenticated=!1,$(a).trigger(s.CustomerEvents.AuthStateChange,a.authenticated),e(r.StatusCode,r.StatusMessage)}};$.ajax(r)},t.prototype.update=function(t,e){var a=this;void 0===e&&(e=function(){}),this.requiedAuthenticate(e)&&$.ajax({type:"POST",url:n.CustomerConfig.updateCustomerUrl,dataType:"json",data:t,headers:{token:this._token}}).done(function(t){200===t.StatusCode?($(a).trigger(s.CustomerEvents.CustomerEdited,t.Data),a.user=t.Data,e(null,t.Data)):e(t.StatusCode,t.StatusMessage)}).fail(function(t,a,n){e(a,n)})},t.getCards=function(){return this.cards=JSON.parse(localStorage.getItem(n.CustomerConfig.cardsStorage)),this.cards||(this.cards=[]),$(this).trigger(s.CustomerEvents.CardsChange,{data:this.cards}),this.cards},t.saveCards=function(){localStorage.setItem(n.CustomerConfig.cardsStorage,JSON.stringify(this.cards))},t.addToCard=function(t){var e=0,a=this.cards.filter(function(a,n){return a.Id==t.Id&&(e=n,!0)});a.length>0?this.cards[e].Quantity++:(t.Quantity=1,this.cards.push(t)),this.saveCards(),$(this).trigger(s.CustomerEvents.CardsChange,{data:this.cards})},t.removeCard=function(t){var e=0,a=this.cards.filter(function(a,n){return a.Id==t.Id&&(e=n,!0)});a.length>0&&(this.cards.splice(e,1),this.saveCards(),$(this).trigger(s.CustomerEvents.CardsChange,{data:this.cards}))},t.decreaseCard=function(t){var e=0,a=this.cards.filter(function(a,n){return a.Id==t.Id&&(e=n,!0)});a.length>0&&(1==this.cards[e].Quantity?this.cards.splice(e,1):this.cards[e].Quantity--,this.saveCards(),$(this).trigger(s.CustomerEvents.CardsChange,{data:this.cards}))},t.prototype.getBills=function(t){void 0===t&&(t=function(){}),this.requiedAuthenticate(t)&&$.ajax({type:"POST",url:n.CustomerConfig.getBillsUrl,dataType:"json",headers:{token:this._token}}).done(function(e){200===e.StatusCode?t(null,e.Data):t(e.StatusCode,e.StatusMessage)}).fail(function(e,a,n){t(a,n)})},t.getAllProducts=function(t){$.ajax({type:"GET",url:n.CustomerConfig.getAllProductsUrl,dataType:"json",crossDomain:!0}).done(function(e){200===e.StatusCode?(e.Data.forEach(function(t){t.Thumbnail=o.ServerConfig.host+o.ServerConfig.filesPath+t.Thumbnail}),t(null,e.Data)):t(e.StatusCode,e.StatusMessage)}).fail(function(e,a,n){t(a,n)})},t.events=s.CustomerEvents,t.cards=[],t}();e.Customer=u},function(t,e,a){"use strict";var n=a(3),o=function(){function t(){}return t.getAllCategory=function(t){var e={async:!0,crossDomain:!0,url:n.EmployeeConfig.GetAllCategoryUrl,method:"GET",success:function(e,a,n){var o=JSON.parse(n.responseText);200===o.StatusCode?t(null,o.Data):t(o.StatusCode,o.StatusMessage)},error:function(e,a,n){var o=JSON.parse(e.responseText);t(o.StatusCode,o.StatusMessage)}};$.ajax(e)},t}();e.Employee=o},function(t,e,a){"use strict";var n=a(7),o=a(8);t.exports={Customer:n.Customer,Employee:o.Employee}}])});
//# sourceMappingURL=innoway.min.js.map